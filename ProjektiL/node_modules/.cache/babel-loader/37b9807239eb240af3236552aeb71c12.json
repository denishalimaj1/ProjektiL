{"ast":null,"code":"const pathToRegexp = require('path-to-regexp');\n\nconst compilePath = (url, params) => pathToRegexp.compile(url)(params);\n\nconst uriReducer = (res = [], [key, val]) => res.concat(Array.isArray(val) ? val.reduce((res, val, i) => uriReducer(res, [`${key}[]`, val]), []) : typeof val === 'object' ? Object.entries(val).reduce((res, [i, val]) => uriReducer(res, [`${key}[${i}]`, val]), []) : `${encodeURIComponent(key)}=${encodeURIComponent(val)}`);\n\nconst withQuestion = res => res.length && `?${res}` || '';\n\nconst buildQueryString = payload => withQuestion(typeof payload === 'string' ? payload : Object.entries(payload).reduce(uriReducer, []).join('&'));\n\nconst defaultStatusValidator = status => status >= 200 && status < 300;\n\nexport default {\n  createState: () => ({\n    status: null,\n    headers: null,\n    body: null,\n    progress: null\n  }),\n\n  callback({\n    payload,\n    resolve,\n    reject,\n    emit,\n    setResult,\n    setCancelCallback\n  }) {\n    const xhr = new XMLHttpRequest();\n    setCancelCallback(xhr.abort);\n    xhr.open(payload.method, payload.url, true);\n\n    xhr.onprogress = e => {\n      setResult({\n        progress: (e.loaded || 0) / (e.total || 1)\n      });\n    };\n\n    xhr.onload = e => {\n      const res = {\n        status: e.target.status,\n        headers: payload.headers,\n        body: e.target.response,\n        progress: 1\n      };\n\n      try {\n        res.body = JSON.parse(e.target.response);\n      } catch (_) {\n        res.body = e.target.response;\n      }\n\n      if (payload.validateStatus(e.target.status)) {\n        resolve(res);\n      } else {\n        reject(res);\n      }\n    };\n\n    xhr.send(payload.method.toLowerCase() === 'get' ? null : payload.body);\n  },\n\n  convert(payload) {\n    var res = {\n      url: compilePath(payload.url, payload.params || {}),\n      body: 'body' in payload ? payload.body : null,\n      method: payload.method || 'GET',\n      headers: payload.headers || {},\n      validateStatus: payload.validateStatus || defaultStatusValidator\n    };\n\n    if (payload.query) {\n      res.url += buildQueryString(payload.query);\n    }\n\n    if (typeof payload.body === 'object' && !(payload.body instanceof FormData)) {\n      res.headers['Content-Type'] = 'application/json';\n    }\n\n    return res;\n  },\n\n  merge(from, to) {\n    const res = Object.assign({}, from, to);\n\n    if (to.url !== undefined && from.url !== undefined) {\n      res.url = to.url[0] === '/' ? to.url : [from.url, to.url].join('/');\n    }\n\n    return res;\n  }\n\n};","map":{"version":3,"sources":["C:/Users/Arber Lluka/Desktop/P3/ProjektiLab/node_modules/@apicase/adapter-xhr/index.js"],"names":["pathToRegexp","require","compilePath","url","params","compile","uriReducer","res","key","val","concat","Array","isArray","reduce","i","Object","entries","encodeURIComponent","withQuestion","length","buildQueryString","payload","join","defaultStatusValidator","status","createState","headers","body","progress","callback","resolve","reject","emit","setResult","setCancelCallback","xhr","XMLHttpRequest","abort","open","method","onprogress","e","loaded","total","onload","target","response","JSON","parse","_","validateStatus","send","toLowerCase","convert","query","FormData","merge","from","to","assign","undefined"],"mappings":"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","sourcesContent":["const pathToRegexp = require('path-to-regexp')\r\n\r\nconst compilePath = (url, params) => pathToRegexp.compile(url)(params)\r\n\r\nconst uriReducer = (res = [], [key, val]) =>\r\n  res.concat(\r\n    Array.isArray(val)\r\n      ? val.reduce((res, val, i) => uriReducer(res, [`${key}[]`, val]), [])\r\n      : typeof val === 'object'\r\n        ? Object.entries(val).reduce(\r\n          (res, [i, val]) => uriReducer(res, [`${key}[${i}]`, val]),\r\n          []\r\n        )\r\n        : `${encodeURIComponent(key)}=${encodeURIComponent(val)}`\r\n  )\r\n\r\nconst withQuestion = res => (res.length && `?${res}`) || ''\r\n\r\nconst buildQueryString = payload =>\r\n  withQuestion(\r\n    typeof payload === 'string'\r\n      ? payload\r\n      : Object.entries(payload)\r\n        .reduce(uriReducer, [])\r\n        .join('&')\r\n  )\r\n\r\nconst defaultStatusValidator = status => status >= 200 && status < 300\r\n\r\nexport default {\r\n  createState: () => ({\r\n    status: null,\r\n    headers: null,\r\n    body: null,\r\n    progress: null\r\n  }),\r\n\r\n  callback({ payload, resolve, reject, emit, setResult, setCancelCallback }) {\r\n    const xhr = new XMLHttpRequest()\r\n    setCancelCallback(xhr.abort)\r\n    xhr.open(payload.method, payload.url, true)\r\n\r\n    xhr.onprogress = e => {\r\n      setResult({\r\n        progress: (e.loaded || 0) / (e.total || 1)\r\n      })\r\n    }\r\n\r\n    xhr.onload = e => {\r\n      const res = {\r\n        status: e.target.status,\r\n        headers: payload.headers,\r\n        body: e.target.response,\r\n        progress: 1\r\n      }\r\n      try {\r\n        res.body = JSON.parse(e.target.response)\r\n      } catch (_) {\r\n        res.body = e.target.response\r\n      }\r\n      if (payload.validateStatus(e.target.status)) {\r\n        resolve(res)\r\n      } else {\r\n        reject(res)\r\n      }\r\n    }\r\n\r\n    xhr.send(payload.method.toLowerCase() === 'get' ? null : payload.body)\r\n  },\r\n\r\n  convert(payload) {\r\n    var res = {\r\n      url: compilePath(payload.url, payload.params || {}),\r\n      body: 'body' in payload ? payload.body : null,\r\n      method: payload.method || 'GET',\r\n      headers: payload.headers || {},\r\n      validateStatus: payload.validateStatus || defaultStatusValidator\r\n    }\r\n    if (payload.query) {\r\n      res.url += buildQueryString(payload.query)\r\n    }\r\n    if (\r\n      typeof payload.body === 'object' &&\r\n      !(payload.body instanceof FormData)\r\n    ) {\r\n      res.headers['Content-Type'] = 'application/json'\r\n    }\r\n    return res\r\n  },\r\n\r\n  merge(from, to) {\r\n    const res = Object.assign({}, from, to)\r\n    if (to.url !== undefined && from.url !== undefined) {\r\n      res.url = to.url[0] === '/' ? to.url : [from.url, to.url].join('/')\r\n    }\r\n    return res\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}